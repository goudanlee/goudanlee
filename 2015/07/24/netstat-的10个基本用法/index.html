<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="goudanlee's blog"><title>netstat 的10个基本用法 | GoudanLee</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">netstat 的10个基本用法</h1><a id="logo" href="/.">GoudanLee</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">netstat 的10个基本用法</h1><div class="post-meta">Jul 24, 2015<span> | </span><span class="category"><a href="/categories/Linux/">Linux</a></span></div><a data-disqus-identifier="2015/07/24/netstat-的10个基本用法/" href="/2015/07/24/netstat-的10个基本用法/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p><strong>Netstat 简介</strong>
Netstat 是一款命令行工具，可用于列出系统上所有的网络套接字连接情况，包括 tcp, udp 以及 unix 套接字，另外它还能列出处于监听状态（即等待接入请求）的套接字。如果你想确认系统上的 Web 服务有没有起来，你可以查看80端口有没有打开。以上功能使 netstat 成为网管和系统管理员的必备利器。在这篇教程中，我会列出几个例子，教大家如何使用 netstat 去查找网络连接信息和系统开启的端口号。</p>
<p>以下的简单介绍来自 netstat 的 man 手册：
netstat - 打印网络连接、路由表、连接的数据统计、伪装连接以及广播域成员。</p>
<h3 id="1-列出所有连接"><a href="#1-列出所有连接" class="headerlink" title="1. 列出所有连接"></a>1. 列出所有连接</h3><p>第一个要介绍的，是最简单的命令：列出所有当前的连接。使用 -a 选项即可。
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">$ netstat -a</div><div class="line"> </div><div class="line">Active Internet connections (servers <span class="keyword">and</span> established)</div><div class="line">Proto Recv-Q Send-Q Local Address Foreign Address State </div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> <span class="symbol">enlightened:</span>domain *<span class="symbol">:*</span> LISTEN</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> <span class="symbol">localhost:</span>ipp *<span class="symbol">:*</span> LISTEN</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> enlightened.<span class="symbol">local:</span><span class="number">54750</span> li24<span class="number">0</span>-<span class="number">5</span>.members.<span class="symbol">li:</span>http ESTABLISHED</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> enlightened.<span class="symbol">local:</span><span class="number">49980</span> del01s07-<span class="keyword">in</span>-f14.<span class="number">1</span><span class="symbol">:https</span> ESTABLISHED</div><div class="line">tcp6 <span class="number">0</span> <span class="number">0</span> ip6-<span class="symbol">localhost:</span>ipp [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:*</span> LISTEN</div><div class="line">udp <span class="number">0</span> <span class="number">0</span> <span class="symbol">enlightened:</span>domain *<span class="symbol">:*</span> </div><div class="line">udp <span class="number">0</span> <span class="number">0</span> *<span class="symbol">:bootpc</span> *<span class="symbol">:*</span> </div><div class="line">udp <span class="number">0</span> <span class="number">0</span> enlightened.<span class="symbol">local:</span>ntp *<span class="symbol">:*</span> </div><div class="line">udp <span class="number">0</span> <span class="number">0</span> <span class="symbol">localhost:</span>ntp *<span class="symbol">:*</span> </div><div class="line">udp <span class="number">0</span> <span class="number">0</span> *<span class="symbol">:ntp</span> *<span class="symbol">:*</span> </div><div class="line">udp <span class="number">0</span> <span class="number">0</span> *<span class="symbol">:</span><span class="number">58570</span> *<span class="symbol">:*</span> </div><div class="line">udp <span class="number">0</span> <span class="number">0</span> *<span class="symbol">:mdns</span> *<span class="symbol">:*</span> </div><div class="line">udp <span class="number">0</span> <span class="number">0</span> *<span class="symbol">:</span><span class="number">49459</span> *<span class="symbol">:*</span> </div><div class="line">udp6 <span class="number">0</span> <span class="number">0</span> fe80::<span class="number">216</span><span class="symbol">:</span><span class="number">36</span><span class="symbol">ff:</span><span class="symbol">fef8:</span>ntp [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:*</span> </div><div class="line">udp6 <span class="number">0</span> <span class="number">0</span> ip6-<span class="symbol">localhost:</span>ntp [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:*</span> </div><div class="line">udp6 <span class="number">0</span> <span class="number">0</span> [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:ntp</span> [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:*</span> </div><div class="line">udp6 <span class="number">0</span> <span class="number">0</span> [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:mdns</span> [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:*</span> </div><div class="line">udp6 <span class="number">0</span> <span class="number">0</span> [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:</span><span class="number">63811</span> [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:*</span> </div><div class="line">udp6 <span class="number">0</span> <span class="number">0</span> [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:</span><span class="number">54952</span> [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:*</span> </div><div class="line">Active UNIX domain sockets (servers <span class="keyword">and</span> established)</div><div class="line">Proto RefCnt Flags Type State I-Node Path</div><div class="line">unix <span class="number">2</span> [ ACC ] STREAM LISTENING <span class="number">12403</span> @/tmp/dbus-IDgfj3UGXX</div><div class="line">unix <span class="number">2</span> [ ACC ] STREAM LISTENING <span class="number">40202</span> @/dbus-vfs-daemon/socket-<span class="number">6</span>nUC6CCx</div></pre></td></tr></table></figure></p>
<p>上述命令列出 tcp, udp 和 unix 协议下所有套接字的所有连接。然而这些信息还不够详细，管理员往往需要查看某个协议或端口的具体连接情况。</p>
<h3 id="2-只列出-TCP-或-UDP-协议的连接"><a href="#2-只列出-TCP-或-UDP-协议的连接" class="headerlink" title="2. 只列出 TCP 或 UDP 协议的连接"></a>2. 只列出 TCP 或 UDP 协议的连接</h3><p>使用 -t 选项列出 TCP 协议的连接：
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$ netstat -<span class="keyword">at</span></div><div class="line">Active Internet connections (servers <span class="keyword">and</span> established)</div><div class="line">Proto Recv-Q Send-Q Local Address Foreign Address State </div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> enlightened:domain *:* LISTEN</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> localhost:ipp *:* LISTEN</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> enlightened.<span class="built_in">local</span>:<span class="number">36310</span> del01s07-<span class="keyword">in</span>-f24<span class="number">.1</span>:<span class="keyword">https</span> ESTABLISHED</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> enlightened.<span class="built_in">local</span>:<span class="number">45038</span> a96<span class="number">-17</span><span class="number">-181</span><span class="number">-10.</span>depl:<span class="keyword">http</span> ESTABLISHED</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> enlightened.<span class="built_in">local</span>:<span class="number">37892</span> ABTS-North-Static-:<span class="keyword">http</span> ESTABLISHED</div><div class="line">.....</div></pre></td></tr></table></figure></p>
<p>使用 -u 选项列出 UDP 协议的连接：
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">$ netstat -au</div><div class="line">Active Internet connections (servers <span class="keyword">and</span> established)</div><div class="line">Proto Recv-Q Send-Q Local Address Foreign Address State </div><div class="line">udp <span class="number">0</span> <span class="number">0</span> *<span class="symbol">:</span><span class="number">34660</span> *<span class="symbol">:*</span> </div><div class="line">udp <span class="number">0</span> <span class="number">0</span> <span class="symbol">enlightened:</span>domain *<span class="symbol">:*</span> </div><div class="line">udp <span class="number">0</span> <span class="number">0</span> *<span class="symbol">:bootpc</span> *<span class="symbol">:*</span> </div><div class="line">udp <span class="number">0</span> <span class="number">0</span> enlightened.<span class="symbol">local:</span>ntp *<span class="symbol">:*</span> </div><div class="line">udp <span class="number">0</span> <span class="number">0</span> <span class="symbol">localhost:</span>ntp *<span class="symbol">:*</span> </div><div class="line">udp <span class="number">0</span> <span class="number">0</span> *<span class="symbol">:ntp</span> *<span class="symbol">:*</span> </div><div class="line">udp6 <span class="number">0</span> <span class="number">0</span> fe80::<span class="number">216</span><span class="symbol">:</span><span class="number">36</span><span class="symbol">ff:</span><span class="symbol">fef8:</span>ntp [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:*</span> </div><div class="line">udp6 <span class="number">0</span> <span class="number">0</span> ip6-<span class="symbol">localhost:</span>ntp [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:*</span> </div><div class="line">udp6 <span class="number">0</span> <span class="number">0</span> [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:ntp</span> [<span class="symbol">:</span><span class="symbol">:</span>]<span class="symbol">:*</span></div></pre></td></tr></table></figure></p>
<p>上面同时显示了 IPv4 和 IPv6 的连接。</p>
<h3 id="3-禁用反向域名解析，加快查询速度"><a href="#3-禁用反向域名解析，加快查询速度" class="headerlink" title="3. 禁用反向域名解析，加快查询速度"></a>3. 禁用反向域名解析，加快查询速度</h3><p>默认情况下 netstat 会通过反向域名解析技术查找每个 IP 地址对应的主机名。这会降低查找速度。如果你觉得 IP 地址已经足够，而没有必要知道主机名，就使用 -n 选项禁用域名解析功能。
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$ netstat -ant</div><div class="line">Active Internet connections (servers <span class="keyword">and</span> established)</div><div class="line">Proto Recv-Q Send-Q Local Address Foreign Address State </div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> <span class="number">127.0</span><span class="meta">.1</span><span class="meta">.1</span>:<span class="number">53</span> <span class="number">0.0</span><span class="meta">.0</span><span class="meta">.0</span>:* LISTEN</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> <span class="number">127.0</span><span class="meta">.0</span><span class="meta">.1</span>:<span class="number">631</span> <span class="number">0.0</span><span class="meta">.0</span><span class="meta">.0</span>:* LISTEN</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> <span class="number">192.168</span><span class="meta">.1</span><span class="meta">.2</span>:<span class="number">49058</span> <span class="number">173.255</span><span class="meta">.230</span><span class="meta">.5</span>:<span class="number">80</span> ESTABLISHED</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> <span class="number">192.168</span><span class="meta">.1</span><span class="meta">.2</span>:<span class="number">33324</span> <span class="number">173.194</span><span class="meta">.36</span><span class="meta">.117</span>:<span class="number">443</span> ESTABLISHED</div><div class="line">tcp6 <span class="number">0</span> <span class="number">0</span> ::<span class="number">1</span>:<span class="number">631</span> :::* LISTEN</div></pre></td></tr></table></figure></p>
<p>上述命令列出所有 TCP 协议的连接，没有使用域名解析技术。So easy ? 非常好。</p>
<h3 id="4-只列出监听中的连接"><a href="#4-只列出监听中的连接" class="headerlink" title="4. 只列出监听中的连接"></a>4. 只列出监听中的连接</h3><p>任何网络服务的后台进程都会打开一个端口，用于监听接入的请求。这些正在监听的套接字也和连接的套接字一样，也能被 netstat 列出来。使用 -l 选项列出正在监听的套接字。
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ netstat -tnl</div><div class="line">Active Internet connections (only servers)</div><div class="line">Proto Recv-Q Send-Q Local Address Foreign Address State </div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> <span class="number">127.0</span><span class="meta">.1</span><span class="meta">.1</span>:<span class="number">53</span> <span class="number">0.0</span><span class="meta">.0</span><span class="meta">.0</span>:* LISTEN</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> <span class="number">127.0</span><span class="meta">.0</span><span class="meta">.1</span>:<span class="number">631</span> <span class="number">0.0</span><span class="meta">.0</span><span class="meta">.0</span>:* LISTEN</div><div class="line">tcp6 <span class="number">0</span> <span class="number">0</span> ::<span class="number">1</span>:<span class="number">631</span> :::* LISTEN</div></pre></td></tr></table></figure></p>
<p>现在我们可以看到处于监听状态的 TCP 端口和连接。如果你查看所有监听端口，去掉 -t 选项。如果你只想查看 UDP 端口，使用 -u 选项，代替 -t 选项。
注意：不要使用 -a 选项，否则 netstat 会列出所有连接，而不仅仅是监听端口。</p>
<h3 id="5-获取进程名、进程号以及用户-ID"><a href="#5-获取进程名、进程号以及用户-ID" class="headerlink" title="5. 获取进程名、进程号以及用户 ID"></a>5. 获取进程名、进程号以及用户 ID</h3><p>查看端口和连接的信息时，能查看到它们对应的进程名和进程号对系统管理员来说是非常有帮助的。举个栗子，Apache 的 httpd 服务开启80端口，如果你要查看 http 服务是否已经启动，或者 http 服务是由 apache 还是 nginx 启动的，这时候你可以看看进程名。
使用 -p 选项查看进程信息。
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">~$ sudo netstat -nlpt</div><div class="line">Active Internet connections (only servers)</div><div class="line">Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> <span class="number">127.0</span><span class="meta">.1</span><span class="meta">.1</span>:<span class="number">53</span> <span class="number">0.0</span><span class="meta">.0</span><span class="meta">.0</span>:* LISTEN <span class="number">1144</span>/dnsmasq</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> <span class="number">127.0</span><span class="meta">.0</span><span class="meta">.1</span>:<span class="number">631</span> <span class="number">0.0</span><span class="meta">.0</span><span class="meta">.0</span>:* LISTEN <span class="number">661</span>/cupsd</div><div class="line">tcp6 <span class="number">0</span> <span class="number">0</span> ::<span class="number">1</span>:<span class="number">631</span> :::* LISTEN <span class="number">661</span>/cupsd</div></pre></td></tr></table></figure></p>
<p>使用 -p 选项时，netstat 必须运行在 root 权限之下，不然它就不能得到运行在 root 权限下的进程名，而很多服务包括 http 和 ftp 都运行在 root 权限之下。
相比进程名和进程号而言，查看进程的拥有者会更有用。使用 -ep 选项可以同时查看进程名和用户名。
<figure class="highlight tap"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ sudo netstat -ltpe</div><div class="line">Active Internet connections (only servers)</div><div class="line">Proto Recv-Q Send-Q Local Address Foreign Address State User Inode PID/Program name</div><div class="line">tcp<span class="number"> 0 </span>0 enlightened:domain *:* LISTEN root<span class="number"> 11090 </span>1144/dnsmasq</div><div class="line">tcp<span class="number"> 0 </span>0 localhost:ipp *:* LISTEN root<span class="number"> 9755 </span>661/cupsd</div><div class="line">tcp6<span class="number"> 0 </span>0 ip6-localhost:ipp [::]:* LISTEN root<span class="number"> 9754 </span>661/cupsd</div></pre></td></tr></table></figure></p>
<p>上面列出 TCP 协议下的监听套接字，同时显示进程信息和一些额外信息。
这些额外的信息包括用户名和进程的索引节点号。这个命令对网管来说很有用。
注意 - 假如你将 -n 和 -e 选项一起使用，User 列的属性就是用户的 ID 号，而不是用户名。</p>
<h3 id="6-打印统计数据"><a href="#6-打印统计数据" class="headerlink" title="6. 打印统计数据"></a>6. 打印统计数据</h3><p>netstat 可以打印出网络统计数据，包括某个协议下的收发包数量。
下面列出所有网络包的统计情况：
<figure class="highlight tap"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">$ netstat -s</div><div class="line">Ip:</div><div class="line"><span class="number"> 32797 </span>total packets received</div><div class="line"><span class="number"> 0 </span>forwarded</div><div class="line"><span class="number"> 0 </span>incoming packets discarded</div><div class="line"><span class="number"> 32795 </span>incoming packets delivered</div><div class="line"><span class="number"> 29115 </span>requests sent out</div><div class="line"><span class="number"> 60 </span>outgoing packets dropped</div><div class="line">Icmp:</div><div class="line"><span class="number"> 125 </span>ICMP messages received</div><div class="line"><span class="number"> 0 </span>input ICMP message failed.</div><div class="line">ICMP input histogram:</div><div class="line">destination unreachable: 125</div><div class="line"><span class="number"> 125 </span>ICMP messages sent</div><div class="line"><span class="number"> 0 </span>ICMP messages failed</div><div class="line">ICMP output histogram:</div><div class="line">destination unreachable: 125</div><div class="line">... OUTPUT TRUNCATED ...</div></pre></td></tr></table></figure></p>
<p>如果想只打印出 TCP 或 UDP 协议的统计数据，只要加上对应的选项（-t 和 -u）即可，so easy。</p>
<h3 id="7-显示内核路由信息"><a href="#7-显示内核路由信息" class="headerlink" title="7. 显示内核路由信息"></a>7. 显示内核路由信息</h3><p>使用 -r 选项打印内核路由信息。打印出来的信息与 route 命令输出的信息一样。我们也可以使用 -n 选项禁止域名解析。
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ netstat -rn</div><div class="line">Kernel IP routing table</div><div class="line">Destination Gateway Genmask Flags MSS Window irtt Iface</div><div class="line"><span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> UG <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> eth0</div><div class="line"><span class="number">192.168</span><span class="number">.1</span><span class="number">.0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span> U <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> eth0</div></pre></td></tr></table></figure></p>
<h3 id="8-打印网络接口"><a href="#8-打印网络接口" class="headerlink" title="8. 打印网络接口"></a>8. 打印网络接口</h3><p>netstat 也能打印网络接口信息，-i 选项就是为这个功能而生。
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ netstat -i</div><div class="line">Kernel Interface table</div><div class="line">Iface MTU Met RX-OK RX-ERR RX-DRP RX-OVR TX-OK TX-ERR TX-DRP TX-OVR Flg</div><div class="line">eth0 <span class="number">1500</span> <span class="number">0</span> <span class="number">31611</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">27503</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> BMRU</div><div class="line">lo <span class="number">65536</span> <span class="number">0</span> <span class="number">2913</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2913</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> LRU</div></pre></td></tr></table></figure></p>
<p>上面输出的信息比较原始。我们将 -e 选项和 -i 选项搭配使用，可以输出用户友好的信息。
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">$ netstat -ie</div><div class="line">Kernel Interface table</div><div class="line">eth0 Link <span class="string">encap:</span>Ethernet HWaddr <span class="number">00</span>:<span class="number">16</span>:<span class="number">36</span>:<span class="string">f8:</span><span class="string">b2:</span><span class="number">64</span> </div><div class="line">inet <span class="string">addr:</span><span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span> <span class="string">Bcast:</span><span class="number">192.168</span><span class="number">.1</span><span class="number">.255</span> <span class="string">Mask:</span><span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></div><div class="line">inet6 <span class="string">addr:</span> <span class="string">fe80:</span>:<span class="number">216</span>:<span class="number">36</span><span class="string">ff:</span><span class="string">fef8:</span>b264/<span class="number">64</span> <span class="string">Scope:</span>Link</div><div class="line">UP BROADCAST RUNNING MULTICAST <span class="string">MTU:</span><span class="number">1500</span> <span class="string">Metric:</span><span class="number">1</span></div><div class="line">RX <span class="string">packets:</span><span class="number">31682</span> <span class="string">errors:</span><span class="number">0</span> <span class="string">dropped:</span><span class="number">0</span> <span class="string">overruns:</span><span class="number">0</span> <span class="string">frame:</span><span class="number">0</span></div><div class="line">TX <span class="string">packets:</span><span class="number">27573</span> <span class="string">errors:</span><span class="number">0</span> <span class="string">dropped:</span><span class="number">0</span> <span class="string">overruns:</span><span class="number">0</span> <span class="string">carrier:</span><span class="number">0</span></div><div class="line"><span class="string">collisions:</span><span class="number">0</span> <span class="string">txqueuelen:</span><span class="number">1000</span> </div><div class="line">RX <span class="string">bytes:</span><span class="number">29637117</span> (<span class="number">29.6</span> MB) TX <span class="string">bytes:</span><span class="number">4590583</span> (<span class="number">4.5</span> MB)</div><div class="line"><span class="symbol"> Interrupt:</span><span class="number">18</span> <span class="string">Memory:</span>da000000-da020000</div><div class="line"> </div><div class="line">lo Link <span class="string">encap:</span>Local Loopback </div><div class="line">inet <span class="string">addr:</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="string">Mask:</span><span class="number">255.0</span><span class="number">.0</span><span class="number">.0</span></div><div class="line">inet6 <span class="string">addr:</span> ::<span class="number">1</span>/<span class="number">128</span> <span class="string">Scope:</span>Host</div><div class="line">UP LOOPBACK RUNNING <span class="string">MTU:</span><span class="number">65536</span> <span class="string">Metric:</span><span class="number">1</span></div><div class="line">RX <span class="string">packets:</span><span class="number">2921</span> <span class="string">errors:</span><span class="number">0</span> <span class="string">dropped:</span><span class="number">0</span> <span class="string">overruns:</span><span class="number">0</span> <span class="string">frame:</span><span class="number">0</span></div><div class="line">TX <span class="string">packets:</span><span class="number">2921</span> <span class="string">errors:</span><span class="number">0</span> <span class="string">dropped:</span><span class="number">0</span> <span class="string">overruns:</span><span class="number">0</span> <span class="string">carrier:</span><span class="number">0</span></div><div class="line"><span class="string">collisions:</span><span class="number">0</span> <span class="string">txqueuelen:</span><span class="number">0</span> </div><div class="line">RX <span class="string">bytes:</span><span class="number">305297</span> (<span class="number">305.2</span> KB) TX <span class="string">bytes:</span><span class="number">305297</span> (<span class="number">305.2</span> KB)</div></pre></td></tr></table></figure></p>
<p>上面的输出信息与 ifconfig 输出的信息一样。</p>
<h3 id="9-netstat-持续输出"><a href="#9-netstat-持续输出" class="headerlink" title="9. netstat 持续输出"></a>9. netstat 持续输出</h3><p>我们可以使用 netstat 的 -c 选项持续输出信息。
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash"> netstat -ct</span></div></pre></td></tr></table></figure></p>
<p>这个命令可持续输出 TCP 协议信息。</p>
<h3 id="10-显示多播组信息"><a href="#10-显示多播组信息" class="headerlink" title="10. 显示多播组信息"></a>10. 显示多播组信息</h3><p>选项 -g 会输出 IPv4 和 IPv6 的多播组信息。
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">$ netstat -g</div><div class="line">IPv6/IPv4 Group Memberships</div><div class="line">Interface RefCnt Group</div><div class="line">--------------- ------ ---------------------</div><div class="line">lo <span class="number">1</span> all-systems.mcast.net</div><div class="line">eth<span class="number">0</span> <span class="number">1</span> <span class="number">224.0</span>.<span class="number">0</span>.<span class="number">251</span></div><div class="line">eth<span class="number">0</span> <span class="number">1</span> all-systems.mcast.net</div><div class="line">lo <span class="number">1</span> ip6-allnodes</div><div class="line">lo <span class="number">1</span> ff01::<span class="number">1</span></div><div class="line">eth<span class="number">0</span> <span class="number">1</span> ff02::fb</div><div class="line">eth<span class="number">0</span> <span class="number">1</span> ff02::<span class="number">1</span><span class="symbol">:fff8</span><span class="symbol">:b264</span></div><div class="line">eth<span class="number">0</span> <span class="number">1</span> ip6-allnodes</div><div class="line">eth<span class="number">0</span> <span class="number">1</span> ff01::<span class="number">1</span></div><div class="line">wlan<span class="number">0</span> <span class="number">1</span> ip6-allnodes</div><div class="line">wlan<span class="number">0</span> <span class="number">1</span> ff01::<span class="number">1</span></div></pre></td></tr></table></figure></p>
<p>更多用法
目前为止我们列出了 netstat 的基本用法，现在让我们一起来 geek 吧～
打印 active 状态的连接
active 状态的套接字连接用 “ESTABLISHED” 字段表示，所以我们可以使用 grep 命令获得 active 状态的连接：
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ netstat -atnp | grep ESTA</div><div class="line">(<span class="keyword">Not</span> all processes could be identified, non-owned process info</div><div class="line">will <span class="keyword">not</span> be shown, you would have to be root to see it all.)</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> <span class="number">192.168</span><span class="meta">.1</span><span class="meta">.2</span>:<span class="number">49156</span> <span class="number">173.255</span><span class="meta">.230</span><span class="meta">.5</span>:<span class="number">80</span> ESTABLISHED <span class="number">1691</span>/chrome</div><div class="line">tcp <span class="number">0</span> <span class="number">0</span> <span class="number">192.168</span><span class="meta">.1</span><span class="meta">.2</span>:<span class="number">33324</span> <span class="number">173.194</span><span class="meta">.36</span><span class="meta">.117</span>:<span class="number">443</span> ESTABLISHED <span class="number">1691</span>/chrome</div></pre></td></tr></table></figure></p>
<p>配合 watch 命令监视 active 状态的连接：
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash"> watch <span class="_">-d</span> -n0 <span class="string">"netstat -atnp | grep ESTA"</span></span></div></pre></td></tr></table></figure></p>
<p>查看服务是否在运行
如果你想看看 http,smtp 或 ntp 服务是否在运行，使用 grep。
<figure class="highlight tap"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$ sudo netstat -aple | grep ntp</div><div class="line">udp<span class="number"> 0 </span>0 enlightened.local:ntp *:* root<span class="number"> 17430 </span>1789/ntpd</div><div class="line">udp<span class="number"> 0 </span>0 localhost:ntp *:* root<span class="number"> 17429 </span>1789/ntpd</div><div class="line">udp<span class="number"> 0 </span>0 *:ntp *:* root<span class="number"> 17422 </span>1789/ntpd</div><div class="line">udp6<span class="number"> 0 </span>0 fe80::216:36ff:fef8:ntp [::]:* root<span class="number"> 17432 </span>1789/ntpd</div><div class="line">udp6<span class="number"> 0 </span>0 ip6-localhost:ntp [::]:* root<span class="number"> 17431 </span>1789/ntpd</div><div class="line">udp6<span class="number"> 0 </span>0 [::]:ntp [::]:* root<span class="number"> 17423 </span>1789/ntpd</div><div class="line">unix<span class="number"> 2 </span>[ ] DGRAM<span class="number"> 17418 </span>1789/ntpd</div></pre></td></tr></table></figure></p>
<p>从这里可以看到 ntp 服务正在运行。使用 grep 命令你可以查看 http 或 smtp 或其它任何你想查看的服务。
好了，netstat 的大部分功能都介绍过了，如果你想知道 netstat 更高级的功能，阅读它的手册吧（man netstat）。</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://goudanlee.com/2015/07/24/netstat-的10个基本用法/" data-id="cj43wsovo001q1ktwlhcv4ic4" class="article-share-link">分享</a><div class="tags"><a href="/tags/Linux/">Linux</a><a href="/tags/Shell/">Shell</a></div><div class="post-nav"><a href="/2015/09/01/Oracle切换undo表空间/" class="pre">Oracle切换undo表空间</a><a href="/2015/07/15/Oracle-行列转换逻辑/" class="next">Oracle 行列转换逻辑</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论 「请确保 disqus.com 可以正常加载」</button></div><script>var disqus_shortname = 'goudanlee-com';
var disqus_identifier = '2015/07/24/netstat-的10个基本用法/';
var disqus_title = 'netstat 的10个基本用法';
var disqus_url = 'http://goudanlee.com/2015/07/24/netstat-的10个基本用法/';
$('.btn_click_load').click(function() {
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  $('.btn_click_load').css('display','none');
});
$.ajax({
  url: 'https://disqus.com/favicon.ico',
  timeout: 3000,
  type: 'GET',
  success: (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    $('.btn_click_load').css('display','none');
  })(),
  error: function() {
    $('.btn_click_load').css('display','block');
  }
});</script><script id="dsq-count-scr" src="//goudanlee-com.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/DAND/">DAND</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Oracle/">Oracle</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/R/">R</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Shell/">Shell</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据分析/">数据分析</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/">机器学习</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/CentOS/" style="font-size: 12.14px;">CentOS</a> <a href="/tags/Python/" style="font-size: 20.71px;">Python</a> <a href="/tags/lxml/" style="font-size: 10px;">lxml</a> <a href="/tags/R/" style="font-size: 16.43px;">R</a> <a href="/tags/DAND/" style="font-size: 22.86px;">DAND</a> <a href="/tags/机器学习/" style="font-size: 14.29px;">机器学习</a> <a href="/tags/算法/" style="font-size: 10px;">算法</a> <a href="/tags/朴素贝叶斯/" style="font-size: 10px;">朴素贝叶斯</a> <a href="/tags/HEXO/" style="font-size: 10px;">HEXO</a> <a href="/tags/数据分析/" style="font-size: 18.57px;">数据分析</a> <a href="/tags/Redhat/" style="font-size: 12.14px;">Redhat</a> <a href="/tags/BeatifulSoup/" style="font-size: 10px;">BeatifulSoup</a> <a href="/tags/Linux/" style="font-size: 16.43px;">Linux</a> <a href="/tags/Oracle/" style="font-size: 25px;">Oracle</a> <a href="/tags/SVM/" style="font-size: 10px;">SVM</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/MongoDB/" style="font-size: 10px;">MongoDB</a> <a href="/tags/Shell/" style="font-size: 14.29px;">Shell</a> <a href="/tags/Zabbix/" style="font-size: 10px;">Zabbix</a> <a href="/tags/线性回归/" style="font-size: 10px;">线性回归</a> <a href="/tags/靈魂歌手/" style="font-size: 10px;">靈魂歌手</a> <a href="/tags/Data-scientist/" style="font-size: 10px;">Data scientist</a> <a href="/tags/Pandas/" style="font-size: 10px;">Pandas</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/06/19/线性回归的R-square/">线性回归的R-square</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/19/SupportVectorMachine/">机器学习常见算法之支持向量机SVM</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/13/NavieBayes/">机器学习常见算法之朴素贝叶斯(Navie Bayes)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/09/WineQualityReds/">WineQualityReds EDA</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/07/Histogram-how-to-select-bins/">Histogram how to select bins</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/01/靈魂歌手/">靈魂歌手</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/25/Correlation-Pearson-Kendall-Spearman/">Pearson, Kendall, Spearman三种相关性的差异</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/21/R-operators/">R 逻辑操作符</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/20/dand-osm/">DAND“整理 OpenStreetMap 数据”学习总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/24/数据科学家与数据工程师/">数据科学家与数据工程师</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><script type="text/javascript" src="//goudanlee-com.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://github.com/goudanlee/goudanlee.github.io" title="Github" target="_blank">Github</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">GoudanLee.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>